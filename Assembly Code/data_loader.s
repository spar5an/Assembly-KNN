#include <xc.inc>

    
global	setup_data, load_data, data_loc
;this is a temporary solution to load some data in to begin coding the KNN
;20 binary data points with 3 parameters each

PSECT udata_bank2
data_loc:   ds	80

    
psect udata_acs
data_length:	ds  1
counter:    ds	1

    
psect	data_code, class=CODE
data:
	db	    0xb1, 0x16, 0xbf, 0x1, 0xff, 0xcc, 0x23, 0x0, 0xc, 0x5, 0x73, 0x1, 0x0, 0x7, 0xff, 0x1, 0x88, 0xe1, 0x50, 0x0, 0x46, 0xe, 0x57, 0x1, 0x66, 0x24, 0xac, 0x1, 0x69, 0x6, 0xe5, 0x1, 0x7b, 0xf4, 0x63, 0x0, 0x34, 0x0, 0xa8, 0x1, 0xda, 0xf0, 0x5, 0x0, 0x37, 0x9, 0xa6, 0x1, 0x20, 0x10, 0xbd, 0x1, 0x42, 0xda, 0x16, 0x0, 0xcf, 0xdc, 0x84, 0x0, 0xb5, 0xcf, 0x1d, 0x0, 0xdb, 0xd4, 0x16, 0x0, 0x34, 0xff, 0x0, 0x0, 0x97, 0x21, 0x8f, 0x1, 0x9d, 0xcd, 0x61, 0x0
	align   2

setup_data:
	bcf	    CFGS
	bsf	    EEPGD
	
	movlw	0x50;60 in hex
	movwf	data_length
    
	return
    
load_data:
    	lfsr	0, data_loc	; Load FSR0 with address in RAM	
	movlw	low highword(data)	; address of data in PM
	movwf	TBLPTRU, A	; load upper bits to TBLPTRU
	movlw	high(data)	; address of data in PM
	movwf	TBLPTRH, A	; load high byte to TBLPTRH
	movlw	low(data)	; address of data in PM
	movwf	TBLPTRL, A	; load low byte to TBLPTRL
	movf	data_length, W		
	movwf 	counter, A	; our counter register
	
	bra	loop

loop:
        tblrd*+			; move one byte from PM to TABLAT, increment TBLPRT
	movff	TABLAT, POSTINC0	; move read data from TABLAT to (FSR0), increment FSR0	
	decfsz	counter, A	; count down to zero
	bra	loop		; keep going until finished
	
	return
